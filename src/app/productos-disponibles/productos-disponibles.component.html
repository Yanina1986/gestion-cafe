<div class="row mb-4" *ngIf="mostrarFactura === false">
  <div class="col">
    <h2 class="text-center">Productos Disponibles</h2>
  </div>
</div>
<div class="row">
  <!-- Listado de productos -->
  <div class="col-md-4 mb-3" *ngFor="let producto of productos">
    <div class="card h-100">
      <img
        [src]="producto.imagen || 'https://via.placeholder.com/150'"
        class="card-img-top"
        alt="Imagen del producto"
      >
      <div class="card-body">
        <h5 class="card-title">{{ producto.nombre }}</h5>
        <p class="card-text">{{ producto.descripcion }}</p>
        <p class="card-text">Precio: ${{ producto.precio_ars }} ARS</p>
        <button
          class="btn btn-success w-100"
          (click)="agregarAlCarrito(producto)"
        >
          Agregar al carrito
        </button>
      </div>
    </div>
  </div>
</div>
<div class="row mt-4">
  <div class="row">
    <div class="col-3">
      <span class="">Total del productos en el carrito: </span>
    </div>
    <div class="col-1 text-end">
      <span>{{ carrito.length }} items</span>
    </div>
  </div>
  <div row="row">
    <div class="col-3 text-center">
      <span>Tasa de cambio actual: </span>
    </div>
    <div class="col-1 text-end">
      <span>{{ dolar | number:'1.2-2' }} ARS/USD</span>
    </div>
  </div>
  <div class="col-2 text-end">
    <h5 class="">Total en USD: ${{ getTotalUSD() | number:'1.2-2' }}</h5>
  </div>
  <div class="col-2 text-end">
    <button class="btn btn-danger" (click)="vaciarCarrito()">
      Vaciar carrito
    </button>
    <button class="btn btn-warning ms-2" (click)="verCarrito()">
      Finalizar compra
    </button>
  </div>
</div>
<div class="row mt-4" *ngIf="mostrarFactura === true">
  <!-- Carrito y factura -->
  <div class="col-8">
    <div class="card h-100 text-white" style="background: linear-gradient(135deg, #fc466b, #3f5efb); border: none;">
      <hr class="my-4">
      <h3>ðŸ›’ Carrito de compras</h3>

      <table class="table table-striped table-bordered" *ngIf="carrito.length > 0">
        <thead class="table-dark">
          <tr>
            <th>Producto</th>
            <th>Cantidad</th>
            <th>Precio Unitario</th>
            <th>Total</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of carrito">
            <td>{{ item.nombre }}</td>
            <td>{{ item.cantidad }}</td>
            <td>${{ item.precio }}</td>
            <td>${{ item.precio * item.cantidad }}</td>
            <td>
              <button class="btn btn-sm btn-danger" (click)="quitarDelCarrito(item)">Quitar</button>
            </td>
          </tr>
        </tbody>
      </table>

      <p *ngIf="carrito.length === 0">No hay productos en el carrito.</p>

      <div class="mt-3">
        <button class="btn btn-primary" *ngIf="carrito.length > 0" (click)="mostrarFacturaToggle()">
          Generar factura
        </button>
        <button class="btn btn-secondary ms-2" (click)="listaProducto()">
          Lista de productos
        </button>
        <button class="btn btn-success ms-2" (click)="mostrarFactura = true">
          Ver factura
        </button>
      </div>

      <app-factura
        *ngIf="mostrarFactura"
        [carrito]="carrito"
        [dolar]="dolar"
        (confirmar)="procesarCompra()"
        (cancelar)="mostrarFactura = false">
      </app-factura>
    </div>
  </div>

  <!-- Chat -->
  <div class="col-4">
    <app-chat></app-chat>
  </div>
</div>

